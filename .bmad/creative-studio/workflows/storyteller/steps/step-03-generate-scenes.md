# Step 03: Generate Scene Breakdown

**Goal:** Create scene-by-scene breakdown and output files for screenwriter.

**Scope:** Scene structure, file creation, pipeline state update.

**Token Budget:** ~350 tokens (scene generation + file operations)

---

## SCENE GENERATION

### 1. Determine Scene Count

Based on target duration and emotional complexity:

| Target Duration | Recommended Scenes | Notes |
|-----------------|-------------------|-------|
| 3-5 minutes | 6-10 scenes | Quick emotional arc |
| 5-10 minutes | 10-15 scenes | Standard short film |
| 10-15 minutes | 15-20 scenes | Complex narrative |

**Default:** 10-15 scenes for 5-10 minute target duration.

### 2. Build Emotional Arc

Map emotions across scenes:

```
SCENE PROGRESSION:
1-3:   Establishment - introduce character, hint at emotion
4-6:   Development - deepen emotional state
7-9:   Intensification - peak emotional moments
10-12: Resolution/Transformation - emotional shift or culmination
```

### 3. Generate Each Scene

For each scene, use this template:

```markdown
### Scene [N]: [Brief Title]

**Location:** [Specific, filmable location]
**Time:** [Time of day / time progression]
**Duration:** [Estimated duration in seconds]

**Visual Action:**
[2-4 sentences describing what character PHYSICALLY DOES - visible actions only]

**Key Visuals:**
- [Specific visual element 1]
- [Specific visual element 2]
- [Specific visual element 3]

**Emotional Beat:** [What audience should FEEL watching this]

**Story Logic:** [How this scene translates original metaphor - reference transformation]
```

### 4. Scene Quality Checklist

For each scene, verify:

- [ ] Location is specific and filmable
- [ ] Actions are VISIBLE (not internal thoughts)
- [ ] Key visuals are concrete enough for image generation
- [ ] Emotional beat is clear
- [ ] Story logic explains connection to source material

---

## OUTPUT FILE CREATION

### File A: Scene Breakdown Markdown

**File path:** `{active_project_path}/02-storyteller/scenes-{timestamp}.md`

**Timestamp format:** ISO8601 with hyphens: `YYYY-MM-DDTHH-MM-SSZ`

**Content structure:**

```markdown
# Visual Story Breakdown: [Title]

## Source Material Summary

- **Original Concept:** [From diverse-content-gen, brief summary]
- **Selected Idea:** #[id] - [title]
- **Emotional Core:** [Primary emotion identified]
- **Tone:** [Preserved from source]
- **Target Duration:** [duration estimate]

## Character(s)

### [Character Name/Role]
**Visual Description:** [Age, appearance, notable features]
**Emotional State:** [Their emotional condition throughout]
**Key Behaviors:** [Recurring actions or mannerisms]

## Scene-by-Scene Breakdown

### Scene 1: [Title]
[Full scene template as above]

---

### Scene 2: [Title]
[Continue for all scenes...]

---

## Story Logic Map

| # | Original Metaphor | Emotional Core | Visual Translation | Scene(s) |
|---|-------------------|----------------|-------------------|----------|
| 1 | "..." | ... | ... | 3, 7 |
| 2 | "..." | ... | ... | 5, 9, 11 |

## Emotional Arc

```
Scene 1-3:   [Establishment description]
Scene 4-6:   [Development description]
Scene 7-9:   [Intensification description]
Scene 10+:   [Resolution description]
```

## Technical Notes for Screenwriter

- [Pacing notes]
- [Transition suggestions]
- [Visual consistency requirements]
- [Any specific formatting needs]

---

*Generated by Storyteller Workflow*
*Source: diverse-content-gen output*
*Ready for: Screenwriter formatting*
```

### File B: Tracking Metadata (Optional)

**Note:** With per-project architecture, metadata can be embedded in the content file or stored separately as needed. The pipeline state in `pipeline-state.yaml` is the source of truth.

---

## UPDATE PIPELINE STATE

**CRITICAL:** Update BOTH the project-specific pipeline state AND the projects registry.

### Step C: Update Pipeline State

#### C1: Update Project Pipeline State

Use the **Edit** tool to update the per-project pipeline state file.

**Step 1:** Read projects registry to get active project path
**File:** `{project-root}/.bmad/creative-studio/_state/projects-registry.yaml`

**Step 2:** Edit the project's pipeline state file
**File:** `{active_project_path}/pipeline-state.yaml`

**Find this text (old_string):**
```yaml
current_stage: 1
last_updated: "{old_timestamp}"
```

**Replace with (new_string):**
```yaml
current_stage: 2
last_updated: "{timestamp}"
```

**THEN find this text (old_string):**
```yaml
  "02-storyteller":
    status: "pending"
    outputs: []
    output_location: "/02-storyteller/"
    input_from: "01-diverse"
```

**Replace with (new_string):**
```yaml
  "02-storyteller":
    status: "completed"
    completed_at: "{timestamp}"
    outputs: ["scenes-{timestamp}.md"]
    output_location: "/02-storyteller/"
    input_from: "01-diverse"
```

**THEN find this text (old_string):**
```yaml
  "03-screenwriter":
    status: "pending"
    outputs: []
    output_location: "/03-screenwriter/"
    input_from: "02-storyteller"
```

**Replace with (new_string):**
```yaml
  "03-screenwriter":
    status: "ready"
    outputs: []
    output_location: "/03-screenwriter/"
    input_from: "02-storyteller"
```

**THEN find this text (old_string):**
```yaml
# Quick Access
next_stage_ready: true
next_stage: "02-storyteller"
last_output: "/01-diverse/diverse-content-gen-{old_timestamp}.md"
```

**Replace with (new_string):**
```yaml
# Quick Access
next_stage_ready: true
next_stage: "03-screenwriter"
last_output: "/02-storyteller/scenes-{timestamp}.md"
```

#### C2: Update Projects Registry

Use the **Edit** tool to update the registry.

**File:** `{project-root}/.bmad/creative-studio/_state/projects-registry.yaml`

**Find the active project entry and update:**

**Find this text (old_string):**
```yaml
    current_stage: 1
    stages_completed: ["01-diverse"]
```

**Replace with (new_string):**
```yaml
    current_stage: 2
    stages_completed: ["01-diverse", "02-storyteller"]
```

---

## WORKFLOW COMPLETION

### Summary for User

```
‚úÖ Visual Story Breakdown Complete!

üìÑ Scene Breakdown: {file_path}
üé¨ Total Scenes: {count}
‚è±Ô∏è Estimated Duration: {duration}
üé≠ Emotional Arc: {arc summary}

STORY TRANSFORMATION:
- {N} metaphors translated to filmable visuals
- All scenes verified for filmability
- Story logic map documenting all creative decisions

NEXT STEP OPTIONS:

1. **Continue to Screenwriter Workflow**
   Format scenes into professional screenplay format

2. **Review Scene Breakdown**
   Read through the scenes and request adjustments

3. **Regenerate Specific Scenes**
   Ask me to revise particular scenes

4. **Exit Pipeline**
   Save progress and exit

What would you like to do?
```

### If User Continues to Screenwriter

```
Loading screenwriter workflow...

The screenwriter will:
- Add proper screenplay formatting (sluglines, action blocks)
- Apply industry-standard formatting conventions
- Prepare for production validator review

[Load: {project-root}/.bmad/creative-studio/workflows/screenwriter/workflow.md]
```

---

## COMPLETION CHECKLIST

Before marking workflow complete:

- [ ] Scene breakdown file written
- [ ] Tracking YAML created with ALL handoff fields
- [ ] Pipeline state updated
- [ ] User presented with summary and options

---

**Storyteller workflow complete. Ready for screenwriter or user exit.**
